// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id                 BigInt      @id @default(autoincrement())
  firstname          String
  lastname           String
  email              String      @unique
  username           String      @unique
  password           String
  verifyOtp          String?     // ใช้เก็บรหัส OTP สำหรับ verify email
  verifyOtpExpireAt  DateTime?   // วันหมดอายุ OTP reset
  isAccountVerified  Boolean     @default(false)
  resetOtp           String?     // ใช้เก็บ OTP สำหรับ reset password
  resetOtpExpireAt   DateTime?   // วันหมดอายุ OTP reset
  phone              String?     
  role               Role        @default(USER)
  is_active          Boolean     @default(true)
  firstlogin_at      DateTime? 
  lastlogin_at       DateTime?
  created_at         DateTime    @default(now())
  updated_at         DateTime?
  assets             Asset[]     // ความสัมพันธ์กับตาราง Asset
}

model Asset {
  id             BigInt     @id @default(autoincrement())
  name           String
  description    String?
  serial_number  String     @unique
  status         AssetStatus @default(AVAILABLE)
  assignedTo     User?       @relation(fields: [userId], references: [id])
  userId         BigInt?
  created_at     DateTime   @default(now())
  updated_at     DateTime   @updatedAt
}

enum Role {
  ADMIN
  USER
}

enum AssetStatus {
  AVAILABLE
  ASSIGNED
  MAINTENANCE
  RETIRED
}

